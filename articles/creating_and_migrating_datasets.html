<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating and migrating datasets • quartzbio.edp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating and migrating datasets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">quartzbio.edp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/r_authentication.html">Authentication</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/quartzbio/quartzbio.edp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating and migrating datasets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/quartzbio/quartzbio.edp/blob/main/vignettes/creating_and_migrating_datasets.Rmd" class="external-link"><code>vignettes/creating_and_migrating_datasets.Rmd</code></a></small>
      <div class="d-none name"><code>creating_and_migrating_datasets.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A dataset on the EDP represents a collection of records indexed with
a specific schema (i.e. a list of fields). Datasets make it easy to
query and filter datasets of any size in real-time.</p>
<p>Datasets can be created with a predefined schema (using a Dataset
template) or without any fields. The platform will always detect new
fields in imported records and assign data types; however, users are
recommended to use templates so that the data types of fields can be set
in advance. Records can be added to datasets in multiple ways such as
transforming files into datasets, programmatically generating records,
or copying records from other datasets using “dataset migrations”.</p>
<p>Datasets are designed to be a flexible and scalable solution for
storing structured JSON-compatible data. The molecular data landscape is
filled with a large variety of unique file formats, each with its own
subtleties and quirks. On the EDP, almost any data source can be
imported into a dataset as long as it can be transformed into JSON. The
EDP supports many formats, making it easy to import data into a dataset.
Once the data has been imported into a dataset, users can take advantage
of the many features they offer: scalability, portability, version
control, flexibility of schemas, querying and filtering of data as well
as annotation and analysis using Expressions.</p>
</div>
<div class="section level2">
<h2 id="creating-datasets">Creating Datasets<a class="anchor" aria-label="anchor" href="#creating-datasets"></a>
</h2>
<p>To start working with datasets on the EDP, users can create new,
empty datasets “from scratch”. Datasets have both a schema (dataset
fields) and contents (dataset records). On the EDP, users don’t need to
know their schema in advance (fields are automatically detected from
imported data). However, in many cases crafting a schema (i.e. setting
dataset fields) can help avoid issues with data types and field
names.</p>
<p>To create a dataset, users can supply a full path in the following
format:</p>
<pre><code>&lt;domain&gt;:&lt;vault&gt;:&lt;path&gt;</code></pre>
<p>For example, for a new dataset within a folder in a shared vault:</p>
<pre><code>myDomain:MyVault:/folder/dataset</code></pre>
<p>Or for a new dataset within a folder in a user’s personal vault
(represented by “~/”):</p>
<pre><code>~/folder/dataset</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quartzbio.github.io/quartzbio.edp/">quartzbio.edp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify where you want the new dataset</span></span>
<span><span class="va">vault</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Vault.get_personal_vault.html">Vault.get_personal_vault</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dataset_full_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">vault</span><span class="op">$</span><span class="va">full_path</span>, <span class="st">"/r_examples/my_dataset"</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new, empty dataset</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_or_create_by_full_path.html">Dataset.get_or_create_by_full_path</a></span><span class="op">(</span><span class="va">dataset_full_path</span><span class="op">)</span></span></code></pre></div>
<p>When creating the dataset, users can supply a number of optional
parameters:</p>
<ul>
<li>description: A description (text) of the dataset.</li>
<li>fields: A list of field objects.</li>
<li>capacity: A performance optimization for datasets that will have
tens or hundreds of millions of records. The default is “small” but can
be set to “medium” or “large”. This cannot be changed once it has been
set.</li>
<li>metadata: A dictionary of key/value pairs that can be associated
with the dataset.</li>
<li>tags: A list of strings (tags) that can be associated with the
dataset.</li>
</ul>
</div>
<div class="section level2">
<h2 id="dataset-fields">Dataset Fields<a class="anchor" aria-label="anchor" href="#dataset-fields"></a>
</h2>
<p>By default, new fields are automatically detected by the import
system when transforming a file into a dataset. Users can also provide a
list of fields (i.e. a template) using the fields parameter and
explicitly set names and titles, data types, ordering, descriptions, and
entity types for each field.</p>
<p>Dataset fields have the following properties:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Property</th>
<th>Value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>name (required)</td>
<td>string</td>
<td>The “low-level” field name, is used in JSON-formatted records.</td>
</tr>
<tr class="even">
<td>data_type</td>
<td>string</td>
<td>A valid data type.</td>
</tr>
<tr class="odd">
<td>description</td>
<td>string</td>
<td>Free text that describes the contents of the field.</td>
</tr>
<tr class="even">
<td>entity_type</td>
<td>string</td>
<td>A valid EDP entity type.</td>
</tr>
<tr class="odd">
<td>expression</td>
<td>string</td>
<td>A valid EDP expression.</td>
</tr>
<tr class="even">
<td>is_hidden</td>
<td>boolean</td>
<td>Set to True if the field should be excluded by default from the UI.
The default is False.</td>
</tr>
<tr class="odd">
<td>is_list</td>
<td>boolean</td>
<td>Set to True if multiple values are stored as a list. The default is
False.</td>
</tr>
<tr class="even">
<td>ordering</td>
<td>integer</td>
<td>The order in which this column appears in the UI and in tabular
exports.</td>
</tr>
<tr class="odd">
<td>title</td>
<td>string</td>
<td>The field’s display name is shown in the UI and in tabular exports.
Default is set automatically from the name.</td>
</tr>
<tr class="even">
<td>is_transient</td>
<td>boolean</td>
<td>Set to True if the field is a temporary field used for the purposes
of easier data &amp; expression manipulation during imports &amp;
migrations. The default is False.</td>
</tr>
<tr class="odd">
<td>depends_on</td>
<td>list of strings</td>
<td>List of fields that must have expressions run first before this
field’s expression is evaluated. In other words, what other fields that
this field depends on? The default is an empty list.</td>
</tr>
<tr class="even">
<td>url_template</td>
<td>string</td>
<td>A URL template with one or more “{value}” sections that will be
interpolated with the field value and displayed as a link in the dataset
table</td>
</tr>
</tbody>
</table>
<p>The following example creates a new dataset using a template with two
fields:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quartzbio.github.io/quartzbio.edp/">quartzbio.edp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"my_string_field"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Just a string"</span>,</span>
<span>    data_type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>    is_list <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    is_hidden <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    ordering <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"HUGO Gene Symbol"</span>,</span>
<span>    data_type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>    entity_type <span class="op">=</span> <span class="st">"gene"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vault</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Vault.get_personal_vault.html">Vault.get_personal_vault</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dataset_full_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">vault</span><span class="op">$</span><span class="va">full_path</span>, <span class="st">"/r_examples/my_fields_dataset"</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fields, capacity, and other optional parameters can be set during dataset creation</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_or_create_by_full_path.html">Dataset.get_or_create_by_full_path</a></span><span class="op">(</span><span class="va">dataset_full_path</span>, fields <span class="op">=</span> <span class="va">fields</span>, capacity <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If the dataset already exists, you can add additional fields:</span></span>
<span><span class="fu"><a href="../reference/DatasetField.create.html">DatasetField.create</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"my_new_field"</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"string"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="url-template">URL Template<a class="anchor" aria-label="anchor" href="#url-template"></a>
</h2>
<p>If users add a url_template value to the dataset field, the dataset
table will show the value as a link in the EDP UI. This is useful for
linking to other sources/websites.</p>
</div>
<div class="section level2">
<h2 id="migrating-datasets">Migrating Datasets<a class="anchor" aria-label="anchor" href="#migrating-datasets"></a>
</h2>
<p>Users can perform dataset “migrations” to copy data between or within
datasets as well as use Python-based EDP Expressions to transform data
during migrations. As such, migrations allow users to modify datasets
in-place, making it possible to add, edit, and remove fields. All
dataset migrations have a source dataset and a target dataset (which can
be the same when editing a single dataset).</p>
</div>
<div class="section level2">
<h2 id="copying-datasets">Copying Datasets<a class="anchor" aria-label="anchor" href="#copying-datasets"></a>
</h2>
<p>Copying a dataset is the simplest dataset migration. In this case, a
new dataset is created (the target) and all the records from a source
dataset are copied to it. The source dataset remains unchanged. Copying
datasets can be useful if users do not want to alter the source dataset
or if they do not have write access to the source dataset.</p>
<p>If users do not want to copy the entire source dataset, they can
provide filter parameters to copy a subset. This example copies all
BRCA1 variants from ClinVar into a new dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quartzbio.github.io/quartzbio.edp/">quartzbio.edp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the source dataset</span></span>
<span><span class="va">source_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create your new target dataset</span></span>
<span><span class="va">vault</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Vault.get_personal_vault.html">Vault.get_personal_vault</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dataset_full_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">vault</span><span class="op">$</span><span class="va">full_path</span>, <span class="st">"/r_examples/clinvar"</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span><span class="va">target_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_or_create_by_full_path.html">Dataset.get_or_create_by_full_path</a></span><span class="op">(</span><span class="va">dataset_full_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Copy all variants in BRCA1</span></span>
<span><span class="va">migration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DatasetMigration.create.html">DatasetMigration.create</a></span><span class="op">(</span></span>
<span>  source_id <span class="op">=</span> <span class="va">source_dataset</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  target_id <span class="op">=</span> <span class="va">target_dataset</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  <span class="co"># Omit source_params to copy the whole dataset</span></span>
<span>  source_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"BRCA1"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Wait for the migration to complete</span></span>
<span><span class="fu"><a href="../reference/Dataset.activity.html">Dataset.activity</a></span><span class="op">(</span><span class="va">target_dataset</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="modifying-fields">Modifying Fields<a class="anchor" aria-label="anchor" href="#modifying-fields"></a>
</h2>
<p>The title, description, url_template, ordering, and entity_type of a
field can be modified at any time. Field names cannot be renamed and
fields cannot be removed in-place, though they can be hidden by setting
the is_hidden parameter to TRUE. To change the name of a field, users
must perform a dataset migration to create a new field with the desired
name in the cloned dataset. Similarly, to remove a field from a dataset,
it must be cloned to a new dataset that does not have the field the user
intends to delete. For more information about modifying datasets, users
can refer to the Modifying Datasets documentation.</p>
<p>The following example renames the field of the dataset through a
dataset migration:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve the source dataset</span></span>
<span><span class="va">source_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create your new target dataset</span></span>
<span><span class="va">vault</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Vault.get_personal_vault.html">Vault.get_personal_vault</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dataset_full_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">vault</span><span class="op">$</span><span class="va">full_path</span>, <span class="st">"/r_examples/clinvar_renamed"</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span>
<span><span class="va">target_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_or_create_by_full_path.html">Dataset.get_or_create_by_full_path</a></span><span class="op">(</span><span class="va">dataset_full_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We only want data from these fields</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"clinical_significance"</span>, <span class="st">"review_status"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We want to transform the data by passing target_fields.</span></span>
<span><span class="co"># Because there is no "rename" functionality, the workaround is</span></span>
<span><span class="co"># to create new fields from with the values from the old fields.</span></span>
<span><span class="co"># Set is_transient=TRUE for the old fields so that they are just temporarily</span></span>
<span><span class="co"># used during data transform, and not included in the output.</span></span>
<span><span class="co"># The new fields just take the value of the old fields.</span></span>
<span><span class="va">target_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>    is_transient <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"clinical_significance"</span>,</span>
<span>    is_transient <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"review_status"</span>,</span>
<span>    is_transient <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>    data_type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>    expression <span class="op">=</span> <span class="st">"record.gene"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"clin_sig"</span>,</span>
<span>    data_type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>    expression <span class="op">=</span> <span class="st">"record.clinical_significance"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"rev_stat"</span>,</span>
<span>    data_type <span class="op">=</span> <span class="st">"string"</span>,</span>
<span>    expression <span class="op">=</span> <span class="st">"record.review_status"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create migration</span></span>
<span><span class="co">#  source_params</span></span>
<span><span class="co">#   fields kwarg returns only the fields defined</span></span>
<span><span class="co">#   limit kwarg pulls only 10 records, remove for all records</span></span>
<span><span class="co">#  target_fields</span></span>
<span><span class="co">#  defines the field transform template</span></span>
<span><span class="va">migration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DatasetMigration.create.html">DatasetMigration.create</a></span><span class="op">(</span></span>
<span>  source_id <span class="op">=</span> <span class="va">source_dataset</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  target_id <span class="op">=</span> <span class="va">target_dataset</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  source_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fields <span class="op">=</span> <span class="va">fields</span>,</span>
<span>    limit <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span>,</span>
<span>  target_fields <span class="op">=</span> <span class="va">target_fields</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="api-endpoints">API Endpoints<a class="anchor" aria-label="anchor" href="#api-endpoints"></a>
</h2>
<p>Methods do not accept URL parameters or request bodies unless
specified. Please note that if your EDP endpoint is
sponsor.edp.aws.quartz.bio, you would use
sponsor.api.edp.aws.quartz.bio.</p>
<div class="section level3">
<h3 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h3>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="18%">
<col width="24%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">create</td>
<td align="center">POST <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/datasets</edp_api_host>
</td>
<td align="center">Create a dataset.</td>
<td align="center">This request requires an authorized user with
permission to create new datasets.</td>
<td align="center">The response contains a single Dataset resource.</td>
</tr></tbody>
</table>
<p>Request Body:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="53%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">name</td>
<td align="center">string</td>
<td align="center">The unique name within the vault for this
dataset.</td>
</tr>
<tr class="even">
<td align="center">vault_id</td>
<td align="center">integer</td>
<td align="center">The vault version in which to create the
dataset.</td>
</tr>
<tr class="odd">
<td align="center">vault_parent_object_id</td>
<td align="center">integer</td>
<td align="center">The folder ID in which to create the dataset. Use
‘null’ to place at ‘/’.</td>
</tr>
<tr class="even">
<td align="center">fields</td>
<td align="center">Dataset Fields</td>
<td align="center">A list of dataset field objects.</td>
</tr>
<tr class="odd">
<td align="center">metadata</td>
<td align="center">object</td>
<td align="center">A dictionary of key/value pairs.</td>
</tr>
<tr class="even">
<td align="center">tags</td>
<td align="center">string</td>
<td align="center">A list of strings to organize the dataset.</td>
</tr>
<tr class="odd">
<td align="center">capacity</td>
<td align="center">string</td>
<td align="center">(Optional) The dataset capacity level (small, medium,
or large).</td>
</tr>
<tr class="even">
<td align="center">storage_class</td>
<td align="center">string</td>
<td align="center">(Optional) The dataset storage class.</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="23%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">delete</td>
<td align="center">DELETE <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/datasets/{DATASET_ID}</edp_api_host>
</td>
<td align="center">Delete a dataset.</td>
<td align="center">This request requires an authorized user with
permission to modify the target dataset.</td>
<td align="center">The response returns “HTTP 200 OK” when
successful.</td>
</tr></tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="23%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">get</td>
<td align="center">GET <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/datasets/{DATASET_ID}</edp_api_host>
</td>
<td align="center">Retrieve metadata about a dataset.</td>
<td align="center">This request requires an authorized user with
permission to view the target dataset.</td>
<td align="center">The response contains a Dataset resource.</td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="dataset-fields-1">Dataset Fields<a class="anchor" aria-label="anchor" href="#dataset-fields-1"></a>
</h3>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="23%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">create</td>
<td align="center">POST <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_fields</edp_api_host>
</td>
<td align="center">Create a dataset field.</td>
<td align="center">This request requires an authorized user with write
permission on the dataset.</td>
<td align="center">The response contains a single DatasetField
resource.</td>
</tr></tbody>
</table>
<p>Request Body: In the request body, provide an object with the
following properties:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="63%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">data_type</td>
<td align="center">string</td>
<td align="center">A valid data type (see below).</td>
</tr>
<tr class="even">
<td align="center">description</td>
<td align="center">string</td>
<td align="center">Describes the contents of the field.</td>
</tr>
<tr class="odd">
<td align="center">entity_type</td>
<td align="center">string</td>
<td align="center">A valid entity type.</td>
</tr>
<tr class="even">
<td align="center">expression</td>
<td align="center">string</td>
<td align="center">A valid expression.</td>
</tr>
<tr class="odd">
<td align="center">is_hidden</td>
<td align="center">boolean</td>
<td align="center">Set to True if the field should be excluded by
default from the UI.</td>
</tr>
<tr class="even">
<td align="center">is_list</td>
<td align="center">boolean</td>
<td align="center">Set to True if multiple values are stored as a
list.</td>
</tr>
<tr class="odd">
<td align="center">name</td>
<td align="center">string</td>
<td align="center">The “low-level” field name, used in JSON formatted
records. Field names are immutable once set. The title and description
of a field can always be changed.</td>
</tr>
<tr class="even">
<td align="center">ordering</td>
<td align="center">integer</td>
<td align="center">The order in which this column appears when
retrieving data from the dataset. Order is 0-based. Default is 0</td>
</tr>
<tr class="odd">
<td align="center">title</td>
<td align="center">string</td>
<td align="center">The field’s display name, shown in the UI and in
CSV/Excel exports.</td>
</tr>
<tr class="even">
<td align="center">url_template</td>
<td align="center">string</td>
<td align="center">A URL template with one or more “{value}” sections
that will be interpolated with the field value and displayed as a link
in the dataset table.</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="data-types">Data Types:<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h4>
<table class="table">
<colgroup>
<col width="23%">
<col width="76%">
</colgroup>
<thead><tr class="header">
<th align="center">Data Type</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">auto (default)</td>
<td align="center">Attempt to automatically detect the data type upon
the first import.</td>
</tr>
<tr class="even">
<td align="center">boolean</td>
<td align="center">Either True, False, or null.</td>
</tr>
<tr class="odd">
<td align="center">date</td>
<td align="center">A string in ISO 8601 format, for example:
“2017-03-29T14:52:01”.</td>
</tr>
<tr class="even">
<td align="center">double</td>
<td align="center">A double-precision 64-bit IEEE 754 floating
point.</td>
</tr>
<tr class="odd">
<td align="center">float</td>
<td align="center">single-precision 32-bit IEEE 754 floating point.</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">A signed 32-bit integer with a minimum value of
-2E+31 and a maximum value of (2E+31)-1.</td>
</tr>
<tr class="odd">
<td align="center">long</td>
<td align="center">A signed 64-bit integer with a minimum value of
-2E+63 and a maximum value of (2E+63)-1.</td>
</tr>
<tr class="even">
<td align="center">object</td>
<td align="center">A key/value, JSON-like object, similar to a Python
dictionary.</td>
</tr>
<tr class="odd">
<td align="center">string</td>
<td align="center">A valid UTF-8 string up to 32,766 characters in
length.</td>
</tr>
<tr class="even">
<td align="center">text</td>
<td align="center">A valid UTF-8 string of any length, indexed for
full-text search.</td>
</tr>
<tr class="odd">
<td align="center">blob</td>
<td align="center">A valid UTF-8 string of any length, not indexed for
search.</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="23%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">get</td>
<td align="center">GET <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_fields/{ID}</edp_api_host>
</td>
<td align="center">Retrieve a dataset field.</td>
<td align="center">This request requires an authorized user with read
permission on the dataset.</td>
<td align="center">The response contains a DatasetField resource.</td>
</tr></tbody>
</table>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">list</td>
<td align="center">GET <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/datasets/{DATASET_ID}/fields</edp_api_host>
</td>
<td align="center">Retrieve a set of dataset fields for a dataset.</td>
<td align="center">This request requires an authorized user with read
permission on the dataset.</td>
<td align="center">The response contains a list of DatasetField
resources.</td>
</tr></tbody>
</table>
<p>Parameters:</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="72%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">limit</td>
<td align="center">integer</td>
<td align="center">The number of objects to return per page.</td>
</tr>
<tr class="even">
<td align="center">offset</td>
<td align="center">integer</td>
<td align="center">The offset within the list of available objects.</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="22%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">update</td>
<td align="center">PUT <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_fields/{ID}</edp_api_host>
</td>
<td align="center">Update a dataset field.</td>
<td align="center">This request requires an authorized user with write
permission on the dataset.</td>
<td align="center">The response contains the updated DatasetField
resource.</td>
</tr></tbody>
</table>
<p>Request Body In the request body, provide a valid DatasetField object
(see create above).</p>
</div>
<div class="section level4">
<h4 id="dataset-migrations">Dataset Migrations<a class="anchor" aria-label="anchor" href="#dataset-migrations"></a>
</h4>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="18%">
<col width="27%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">create</td>
<td align="center">POST <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_migrations</edp_api_host>
</td>
<td align="center">Create a dataset migration.</td>
<td align="center">This request requires an authorized user with read
permissions from the source dataset, and write permissions to the target
dataset.</td>
<td align="center">The response contains a new DatasetMigration
resource.</td>
</tr></tbody>
</table>
<table class="table">
<colgroup>
<col width="21%">
<col width="21%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">commit_mode</td>
<td align="center">string</td>
<td align="center">A valid commit mode.</td>
</tr>
<tr class="even">
<td align="center">include_errors</td>
<td align="center">boolean</td>
<td align="center">If True, a new field (_errors) will be added to each
record containing expression evaluation errors (default: True).</td>
</tr>
<tr class="odd">
<td align="center">source_id</td>
<td align="center">integer</td>
<td align="center">The ID of a valid, queryable dataset.</td>
</tr>
<tr class="even">
<td align="center">source_params</td>
<td align="center">object</td>
<td align="center">The query parameters used on the source dataset (see
below).</td>
</tr>
<tr class="odd">
<td align="center">target_fields</td>
<td align="center">object</td>
<td align="center">A list of valid dataset fields to create or override
in the target dataset.</td>
</tr>
<tr class="even">
<td align="center">target_id</td>
<td align="center">integer</td>
<td align="center">A valid dataset with write permissions.</td>
</tr>
<tr class="odd">
<td align="center">entity_params</td>
<td align="center">object</td>
<td align="center">(optional) Configuration parameters for entity
detection.</td>
</tr>
<tr class="even">
<td align="center">validation_params</td>
<td align="center">object</td>
<td align="center">(optional) Configuration parameters for
validation</td>
</tr>
<tr class="odd">
<td align="center">annotator_params</td>
<td align="center">object</td>
<td align="center">(optional) Configuration parameters for the
Annotator.</td>
</tr>
<tr class="even">
<td align="center">priority</td>
<td align="center">integer</td>
<td align="center">A priority to assign to this task.</td>
</tr>
</tbody>
</table>
<p>The following query parameters (source_params property) are supported
for migrations:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="21%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">limit</td>
<td align="center">integer</td>
<td align="center">The number of records to migrate from the source
dataset.</td>
</tr>
<tr class="even">
<td align="center">filters</td>
<td align="center">objects</td>
<td align="center">A valid filter object.</td>
</tr>
<tr class="odd">
<td align="center">fields</td>
<td align="center">string</td>
<td align="center">A list of fields to include from the source
dataset.</td>
</tr>
<tr class="even">
<td align="center">exclude_fields</td>
<td align="center">string</td>
<td align="center">A list of fields to exclude from the source
dataset.</td>
</tr>
<tr class="odd">
<td align="center">query</td>
<td align="center">string</td>
<td align="center">A valid query string.</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">delete</td>
<td align="center">DELETE <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_migrations/{ID}</edp_api_host>
</td>
<td align="center">Delete a dataset migration.</td>
<td align="center">This request requires an authorized user with write
permissions.</td>
<td align="center">The response returns “HTTP 200 OK” when
successful.</td>
</tr></tbody>
</table>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">get</td>
<td align="center">GET <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset_migrations/{ID}</edp_api_host>
</td>
<td align="center">Retrieve metadata about a dataset migration.</td>
<td align="center">This request requires an authorized user with
permission.</td>
<td align="center">The response contains a DatasetMigration
resource.</td>
</tr></tbody>
</table>
<table class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="19%">
<col width="19%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">list</td>
<td align="center">GET <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/dataset/{DATASET_ID}/migrations</edp_api_host>
</td>
<td align="center">Retrieve a list of dataset migrations for a
dataset.</td>
<td align="center">This request requires an authorized user with read
permission.</td>
<td align="center">The response contains a list of DatasetMigration
resources from the specified source dataset.</td>
</tr></tbody>
</table>
<p>Parameters: This request accepts the following parameters:</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="72%">
</colgroup>
<thead><tr class="header">
<th align="center">Property</th>
<th align="center">Value</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">limit</td>
<td align="center">integer</td>
<td align="center">The number of objects to return per page.</td>
</tr>
<tr class="even">
<td align="center">offset</td>
<td align="center">integer</td>
<td align="center">The offset within the list of available objects.</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Method</th>
<th align="center">HTTP Request</th>
<th align="center">Description</th>
<th align="center">Authorization</th>
<th align="center">Response</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">cancel</td>
<td align="center">PUT <a href="https://" class="external-link uri">https://</a><edp_api_host>/v2/datasets_migrations/{ID}/cancel</edp_api_host>
</td>
<td align="center">Cancel a dataset migration.</td>
<td align="center">This request requires an authorized user with read
permission on the dataset.</td>
<td align="center">The response will contain a DatasetMigration resource
with the status canceled.</td>
</tr></tbody>
</table>
<p>Request Body: In the request body, provide a valid DatasetMigration
object (see create above) with status = canceled.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Caplan, Karl Forner, QuartzBio.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last modified: 21-May-2025 Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
