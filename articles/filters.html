<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Filters • quartzbio.edp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">quartzbio.edp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/r_authentication.html">Authentication</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/quartzbio/quartzbio.edp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/quartzbio/quartzbio.edp/blob/main/vignettes/filters.Rmd" class="external-link"><code>vignettes/filters.Rmd</code></a></small>
      <div class="d-none name"><code>filters.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The EDP provides an easy-to-use, real-time API for querying datasets
and files through the R client library, which also enable the
application of complex filters on dataset and file fields. Users can
also utilize Bash to query and filter datasets.</p>
<p>Users can filter on any field in a dataset or file. Filters can be
applied using 3 syntaxes:</p>
<ul>
<li>Math syntax</li>
<li>API JSON syntax</li>
<li>API syntax in R data structure</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter ClinVar dataset to pathogenic variants</span></span>
<span></span>
<span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37"</span><span class="op">)</span></span>
<span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="st">'[["clinical_significance", "pathogenic"]]'</span></span>
<span><span class="va">records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter ClinVar file to pathogenic variants</span></span>
<span></span>
<span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Object.get_by_full_path.html">Object.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/ClinVar-5-2-0-20210110-Variants-GRCH37-1425664822266145048-20221110194518.json.gz"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Object.query.html">Object.query</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["clinical_significance", "pathogenic"]]'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># There are 3 basic syntaxes that can be used</span></span>
<span></span>
<span><span class="co">### generally, 3 ways</span></span>
<span><span class="co"># math syntax</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span><span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'clinical_significance = "pathogenic"'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># API JSON syntax</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span><span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["clinical_significance", "pathogenic"]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># API syntax in R data structure</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span><span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"clinical_significance"</span>, <span class="st">"pathogenic"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Filters can be modified using “filter actions”, which let users
adjust the condition of a filter. To specify a filter action, users can
append it to the field name when building a filter:</p>
<pre><code>&lt;field&gt;__&lt;action&gt; 
#For example, date__gte for filtering by dates greater or equal to the input</code></pre>
<table class="table">
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th align="center"><strong>Action</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">iexact (default)</td>
<td align="center">Field is equal to value (case-insensitive). If the
field’s value is a list, this will match values within the list, not the
list as a whole.</td>
</tr>
<tr class="even">
<td align="center">exact</td>
<td align="center">Field is an exact match to value. Useful for
case-sensitive string field queries.</td>
</tr>
<tr class="odd">
<td align="center">in</td>
<td align="center">Field is “one of” a list of values. (similar to
Python’s in operator).</td>
</tr>
<tr class="even">
<td align="center">range</td>
<td align="center">Field is a number within two values. Ranges are
inclusive (fully closed).</td>
</tr>
<tr class="odd">
<td align="center">gt</td>
<td align="center">Field is a number greater than value.</td>
</tr>
<tr class="even">
<td align="center">lt</td>
<td align="center">Field is a number less than value.</td>
</tr>
<tr class="odd">
<td align="center">gte</td>
<td align="center">Field is a number greater than or equal to
value.</td>
</tr>
<tr class="even">
<td align="center">lte</td>
<td align="center">Field is a number less than or equal to value.</td>
</tr>
<tr class="odd">
<td align="center">contains</td>
<td align="center">Field contains this string value.</td>
</tr>
<tr class="even">
<td align="center">regexp</td>
<td align="center">Field value matches this regular expression.
(<strong>Note: The action is only compatible with
datasets</strong>)</td>
</tr>
</tbody>
</table>
<p>Some filter actions (range, gt, lt, gte, lte) may only be used on
numeric and date fields.</p>
<p>Full-text fields use the contains filter action by default and act
like a typical search would. Results are ordered by relevance based on
the provided search terms. When using the contains action on string
fields, the system converts the filter into a regular expression:
<code>.*{VALUE}.*</code>, which is equivalent to the SQL expressions
<code>%{VALUE}%.</code></p>
</div>
<div class="section level2">
<h2 id="string-filters">String Filters<a class="anchor" aria-label="anchor" href="#string-filters"></a>
</h2>
<p>Users may filter string fields using the exact (or case-insensitive)
match, regular expression match (regexp), or prefix match (prefix).
Users can also match against multiple strings at once (a boolean or)
using the “in” filter. By default, filters on string fields use the
“equals” match.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filtering dataset using JSON syntax</span></span>
<span><span class="co"># Query Dataset</span></span>
<span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equals match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["gene", "BRCA1"]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equals match (in list)</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["gene__in", ["BRCA1", "BRCA2"]]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Regular expression match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["gene__regexp", "BRCA[12]"]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prefix match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["gene__prefix", "BRCA"]]'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Filtering dataset using Math syntax</span></span>
<span><span class="co"># Equals match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'(gene = "BRCA1")'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equals match (in list)</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'gene IN ("BRCA1", "BRCA2")'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Regular expression match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'gene regexp "BRCA[12]"'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Filtering dataset using R data structure</span></span>
<span><span class="co"># Equals match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"BRCA1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equals match (in list)</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene__in"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"BRCA2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Regular expression match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene__regexp"</span>, <span class="st">"BRCA[12]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prefix match</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gene__prefix"</span>, <span class="st">"BRCA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="text-filters">Text Filters<a class="anchor" aria-label="anchor" href="#text-filters"></a>
</h2>
<p>Long (paragraph-length) fields typically use the text data type. The
“contains” filter in text fields works more like a search than a filter.
Results that match the search term are brought back in the order of
relevance.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Contains match for text fields</span></span>
<span><span class="va">MedLine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/MEDLINE/2.3.4-2018/MEDLINE-sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># JSON Syntax</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">MedLine</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["abstract__contains", "Immunological"]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Math Syntax</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">MedLine</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'(abstract CONTAINS "Immunological")'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R data structure syntax</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">MedLine</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"abstract__contains"</span>, <span class="st">"Immunological"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="numeric-date-filters">Numeric &amp; Date Filters<a class="anchor" aria-label="anchor" href="#numeric-date-filters"></a>
</h2>
<p>Numeric and date fields can be filtered by exact match, exact match
in a list (in), half-open range match (range), and standard operators
(gt, lt, gte, lte). Dates are in the format YYYY-MM-DD.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Equals match</span></span>
<span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37'"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># JSON syntaz</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["info.ORIGIN", 4]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Math syntax</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">"(info.ORIGIN = 4)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R data structure syntax</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"info.ORIGIN"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equals match (in list)</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["info.ORIGIN__in", [1, 2, 3]]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Range query</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["info.ORIGIN__range", [1, 3]]]'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Operator query (gt/gte/lt/lte)</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[["info.ORIGIN__gt", 4]]'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="entity-filters">Entity Filters<a class="anchor" aria-label="anchor" href="#entity-filters"></a>
</h2>
<p>EDP-supported Entities can be used for filtering, without requiring
the exact field name that the Entity resides in. The entity filters are
only compatible with datasets.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37'"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Gene entity query</span></span>
<span><span class="fu"><a href="../reference/Dataset.query.html">Dataset.query</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, entities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"BRCA2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Variant entity query</span></span>
<span><span class="fu"><a href="../reference/Dataset.query.html">Dataset.query</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, entities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variant"</span>, <span class="st">"GRCH37-13-32890599-32890599-C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combining-filters">Combining Filters<a class="anchor" aria-label="anchor" href="#combining-filters"></a>
</h2>
<p>The examples below show how to filter a dataset on one or two fields.
In many cases, users will probably need to combine many filters into a
single query.</p>
<p>When manually writing queries, users can combine and nest filters
using boolean operators (‘and’, ‘or’, ‘not’).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combining filters with boolean operaters with different syntaxes</span></span>
<span></span>
<span><span class="co"># AND</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[{"and": [["gene", "BRCA1"], ["clinical_significance", "pathogenic"]]}]'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'(gene = "BRCA1") AND (clinical_significance = "Pathogenic")'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># OR</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[{"or": [["gene", "BRCA1"], ["gene_symbol", "BRCA2"]]}]'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'(gene = "BRCA1") OR (gene_symbol = "BRCA2")'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NOT</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="st">'[{"not": [["gene", "BRCA1"], ["gene_symbol", "BRCA2"]]}]'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">clinvar</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="fu"><a href="../reference/filters.html">filters</a></span><span class="op">(</span><span class="st">'NOT ((gene = "BRCA1") OR (gene = "BRCA2"))'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="query-strings">Query Strings<a class="anchor" aria-label="anchor" href="#query-strings"></a>
</h2>
<p>Query strings are parsed into a series of terms and operators. A
query string can be provided as part of an EDP dataset query in
combination with filters, or as an alternative to filters. The query
strings are only compatible with datasets.</p>
<p>Terms in a query string can be single words - “quick” or “brown” - or
a phrase surrounded by double quotes - “quick brown” - which will search
for all the words in the phrase, in the same order. The query syntax is
based on the <a href="https://lucene.apache.org/core/2_9_4/queryparsersyntax.html" class="external-link">Lucene
query syntax</a>.</p>
<p>Queries are useful to find records that best match a word or phrase,
relative to others. Filters are designed to reduce the potential result
set by asking yes/no questions on every record in a dataset.</p>
<p>Query string operators allow users to customize a search. The
available options are explained below:</p>
</div>
<div class="section level2">
<h2 id="field-names">Field Names<a class="anchor" aria-label="anchor" href="#field-names"></a>
</h2>
<p>By default, when no field names are specified, all string or text
fields are searched for each term. Users can provide an explicit field
name if they know the field in question:</p>
<p><code>status:active</code></p>
<p>Users can do an exact match on a specific field, for example:</p>
<p><code>gene:"BRCA1"</code></p>
<p>To search for one-or-more terms in a field, users can combine them
with OR (default) or AND:</p>
<pre><code>gene:(TTN) 
gene:(TTN OR BRCA1)
gene_family:(Olfactory AND receptors)</code></pre>
<p>Users can also find records with missing fields:</p>
<p><code>_missing_:sample_id</code></p>
<p>Or, records where the field has a value (i.e. “not missing”):</p>
<p><code>_exists_:sample_id</code></p>
</div>
<div class="section level2">
<h2 id="wildcards">Wildcards<a class="anchor" aria-label="anchor" href="#wildcards"></a>
</h2>
<p>Wildcard searches can be run on individual terms, using ? to replace
a single character, and * to replace zero or more characters:</p>
<p><code>BRCA*</code></p>
</div>
<div class="section level2">
<h2 id="ranges">Ranges<a class="anchor" aria-label="anchor" href="#ranges"></a>
</h2>
<p>Ranges can be specified for almost any field data type. They are most
useful for dates and numeric fields. Inclusive ranges are specified with
square brackets [min TO max] and exclusive ranges with curly brackets
{min TO max}.</p>
<p>For example, this query will retrieve records for all days in
2012:</p>
<p><code>date:[2012-01-01 TO 2012-12-31]</code></p>
<p>Similarly, users can also use ranges on numeric fields:</p>
<p><code>count:[1 TO 5]</code></p>
<p>And use infinite ranges:</p>
<p><code>count:[10 TO *]</code></p>
<p>Standard numeric comparison operators can also be used:</p>
<p><code>age:&gt;10 age:&gt;=10 age:&lt;10 age:&lt;=10</code></p>
<p>To combine an upper and lower bound with the simplified syntax, users
can join two clauses with an AND operator:</p>
<p><code>age:(&gt;=10 AND &lt;20) age:(+&gt;=10 +&lt;20)</code></p>
<p>As processing ranges from a query string is much slower and less
reliable than using an explicit range filter, users should try range
filters first.</p>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<p>Multiple terms or clauses can be grouped together with parentheses to
form sub-queries:</p>
<p><code>(Serine OR Cysteine) AND protease</code></p>
<p>Groups can be used to target a particular field, or to boost the
result of a sub-query:</p>
<p><code>status:(active OR pending) title:(full text search)^2</code></p>
</div>
<div class="section level2">
<h2 id="reserved-characters">Reserved characters<a class="anchor" aria-label="anchor" href="#reserved-characters"></a>
</h2>
<p>The following characters are reserved in query strings and must be
escaped with a leading backslash when used as part of a query term:</p>
<p><code>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ " ~ * ? : \ /</code></p>
<p>For example, to search for the string <code>(1+1)=2</code>, the query
should be written as <code>\(1\+1\)\=2</code>.</p>
</div>
<div class="section level2">
<h2 id="advanced-filters">Advanced Filters<a class="anchor" aria-label="anchor" href="#advanced-filters"></a>
</h2>
<p>Users can also compose filters and apply these filters via R, Python,
or the EDP UI:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Contains match for text fields</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Dataset.get_by_full_path.html">Dataset.get_by_full_path</a></span><span class="op">(</span><span class="st">"quartzbio:Public:/MEDLINE/2.3.4-2018/MEDLINE-sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Include all abstracts with "diabetes"</span></span>
<span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="st">'[</span></span>
<span><span class="st">    ["abstract__contains", "diabetes"]</span></span>
<span><span class="st">]'</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exclude all abstracts with "diabetes"</span></span>
<span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="st">'[{</span></span>
<span><span class="st">    "not": ["abstract__contains", "diabetes"]</span></span>
<span><span class="st">}]'</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find abstracts without "diabetes" from 1977</span></span>
<span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="st">'[{</span></span>
<span><span class="st">    "and": [</span></span>
<span><span class="st">        {"not": ["abstract__contains", "diabetes"]},</span></span>
<span><span class="st">        {</span></span>
<span><span class="st">            "or": [</span></span>
<span><span class="st">                ["date_published__regex", "*1977*"],</span></span>
<span><span class="st">                ["date_created__range", ["1977-01-01", "1977-12-31"]]</span></span>
<span><span class="st">            ]</span></span>
<span><span class="st">        }</span></span>
<span><span class="st">    ]</span></span>
<span><span class="st">}]'</span></span>
<span><span class="fu"><a href="../reference/Dataset_query.html">Dataset_query</a></span><span class="op">(</span>dataset_id <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">id</span>, filters <span class="op">=</span> <span class="va">filters</span><span class="op">)</span></span></code></pre></div>
<p>The advanced filter syntax is composed of the following elements:</p>
<ul>
<li><p>{OPERATOR} is one of AND, OR, or NOT.</p></li>
<li><p>{FIELD} is a documented field name in the dataset.</p></li>
<li><p>{ACTION} is a valid field action in the format {FIELD}__{ACTION}
(see below).</p></li>
<li><p>{VALUE} can be a string, numeric, or list value.</p></li>
</ul>
<p>By default, a {FIELD} with no attached {ACTION} implies the
“case-insensitive equals” (iexact) operator. Full-text (text data type)
fields automatically use the “contains” filter action instead.</p>
<p>String and text actions include:</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th align="center"><strong>Action</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">iexact</td>
<td align="center">(default for string/text) Field is equal to value
(case-insensitive). If the field’s value is a list, matches a value
within the list, not the list as a whole.</td>
</tr>
<tr class="even">
<td align="center">exact</td>
<td align="center">Field is an exact match to value. Useful for longer
string and text fields.</td>
</tr>
<tr class="odd">
<td align="center">in</td>
<td align="center">Field is “one of” a list of values.</td>
</tr>
<tr class="even">
<td align="center">contains</td>
<td align="center">Field contains this string value.</td>
</tr>
<tr class="odd">
<td align="center">regexp</td>
<td align="center">Field value matches this regular expression. (Note:
The action is only compatible with datasets)</td>
</tr>
</tbody>
</table>
<p>Numeric and date field actions include:</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th align="center"><strong>Action</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">exact</td>
<td align="center">(default for numeric/date) Field is an exact match to
value.</td>
</tr>
<tr class="even">
<td align="center">range</td>
<td align="center">Field is a number within two within two values
(inclusive/fully-closed).</td>
</tr>
<tr class="odd">
<td align="center">gt</td>
<td align="center">Field is a number greater than value.</td>
</tr>
<tr class="even">
<td align="center">lt</td>
<td align="center">Field is a number less than value.</td>
</tr>
<tr class="odd">
<td align="center">gte</td>
<td align="center">Field is a number greater than or equal to
value.</td>
</tr>
<tr class="even">
<td align="center">lte</td>
<td align="center">Field is a number less than or equal to value.</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Caplan, Karl Forner, QuartzBio.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last modified: 04-Apr-2025 Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
