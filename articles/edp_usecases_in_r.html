<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>EDP Use Cases with R • quartzbio.edp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EDP Use Cases with R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">quartzbio.edp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/r_authentication.html">Authentication</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/quartzbio/quartzbio.edp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EDP Use Cases with R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/quartzbio/quartzbio.edp/blob/main/vignettes/edp_usecases_in_r.Rmd" class="external-link"><code>vignettes/edp_usecases_in_r.Rmd</code></a></small>
      <div class="d-none name"><code>edp_usecases_in_r.Rmd</code></div>
    </div>

    
    
<p>In this article, you can find examples of using EDP with the R
client.</p>
<div class="section level2">
<h2 id="global-beacons">Global Beacons<a class="anchor" aria-label="anchor" href="#global-beacons"></a>
</h2>
<p>Global Beacon lets anyone in your organization find datasets based on
the entities it contains (i.e. variants, genets, targets). Only datasets
that have entities can be indexed.</p>
<p>For more information about Global Beacons, please review the Global
Beacons Overview article.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://quartzbio.github.io/quartzbio.edp/">"quartzbio.edp"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span>secret <span class="op">=</span> <span class="st">"TOKEN"</span><span class="op">)</span></span></code></pre></div>
<p>First, let’s start with enabling Global Beacon on the dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset ID</span></span>
<span><span class="va">dataset_id</span> <span class="op">&lt;-</span> <span class="st">"1658666726768179211"</span></span>
<span></span>
<span></span>
<span><span class="co"># Turn on Global Beacon on the selected dataset</span></span>
<span><span class="fu"><a href="../reference/Object.enable_global_beacon.html">Object.enable_global_beacon</a></span><span class="op">(</span><span class="va">dataset_id</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check now the status of Global Beacon indexing for the
datasets:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Waiting a minute until indexing is complete</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Getting the status of global beacon on the dataset</span></span>
<span><span class="fu"><a href="../reference/Object.get_global_beacon_status.html">Object.get_global_beacon_status</a></span><span class="op">(</span><span class="va">dataset_id</span><span class="op">)</span></span></code></pre></div>
<p>As we can see from the response, the indexing is complete. It means
that now we can perform a search on dataset entities.</p>
<p>Similarly to enabling Global Beacon for the datasets, you may also
disable it using the disable_global_beacon function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Object.disable_global_beacon.html">Object.disable_global_beacon</a></span><span class="op">(</span><span class="st">"1676139881237207342"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="global-search">Global Search<a class="anchor" aria-label="anchor" href="#global-search"></a>
</h2>
<p>Global Search allows you to search for vaults, files, folders, and
datasets by name, tags, user, date, and other metadata which can be
customized.</p>
<p>For more information about Global Search, please review the Global
Search Overview article.</p>
<p>Similarly to Global Search on the web application, the search
functionality is available through the EDP R client as well.</p>
<div class="section level3">
<h3 id="global-search-functions">Global Search functions<a class="anchor" aria-label="anchor" href="#global-search-functions"></a>
</h3>
<p>GlobalSearch module provides three functions and all of them use the
same set of parameters (filters, entities, query, limit, offset,
etc):</p>
<p><strong>1. GlobalSearch.search</strong></p>
<p>Performs a global search based on provided filters, entities, and
queries (advanced query) and returns an R data frame containing results
from API response. For a full list of results set paginate attribute to
TRUE:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>filters <span class="op">=</span> <span class="st">'[{"and":[["type__in",["dataset"]]]}]'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span>, paginate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>2. GlobalSearch.subjects</strong></p>
<p>Similar to the search function, the subjects function returns the
results in the form of an R data frame. The returned data frame contains
subjects:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GlobalSearch.subjects.html">GlobalSearch.subjects</a></span><span class="op">(</span>entities <span class="op">=</span> <span class="st">'[["gene","BRCA2"]]'</span><span class="op">)</span></span></code></pre></div>
<p><strong>3. GlobalSearch.request</strong></p>
<p>Performs low-level global search based on the provided filters,
similar to what you would do from a web application. In the response
there will be the following attributes:</p>
<ul>
<li>results - list of vault objects (datasets, files, folders, and
vaults). Those are the same - - objects from the “Results” tab on the
GlobalSearch page on Mesh.</li>
<li>total - number of objects in the search results</li>
<li>vaults - list of vaults</li>
<li>subjects - list of subjects</li>
<li>subjects_count - number of subjects in the subjects list</li>
<li>took - the amount of time it took to perform a search</li>
<li>offset - offset for pagination, offset from the first result you
want to fetch</li>
</ul>
<p>You may call the request function by providing some of the following
arguments: filters, entities, query (advanced search query), limit, and
offset:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GlobalSearch.request.html">GlobalSearch.request</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span>, limit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GlobalSearch.request.html">GlobalSearch.request</a></span><span class="op">(</span>entities <span class="op">=</span> <span class="st">'[["gene","BRCA2"]]'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GlobalSearch.request.html">GlobalSearch.request</a></span><span class="op">(</span>entities <span class="op">=</span> <span class="st">'[["gene","BRCA2"]]'</span>, filters <span class="op">=</span> <span class="st">'[{"and":[{"and":[["created_at__range",["2021-11-28","2021-12-28"]]]},["type__in",["dataset"]]]}]'</span><span class="op">)</span></span></code></pre></div>
<p><strong>Recommended functions to use:</strong></p>
<ul>
<li>GlobalSearch.search - for getting the search results.</li>
<li>GlobalSearch.subjects - for getting the subjects.</li>
</ul>
</div>
<div class="section level3">
<h3 id="search-examples">Search Examples<a class="anchor" aria-label="anchor" href="#search-examples"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Global Beacon Search</li>
</ol>
<p>As we previously indexed the dataset, we should be able to perform an
entity search and see that dataset in the results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>entities <span class="op">=</span> <span class="st">'[["gene","BRCA2"]]'</span><span class="op">)</span></span>
<span><span class="va">results</span></span></code></pre></div>
<p>Each result object has the following attributes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Applying filters for Global Search</li>
</ol>
<p>Search only for vaults:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>filters <span class="op">=</span> <span class="st">'[{"and":[["type__in",["vault"]]]}]'</span><span class="op">)</span></span>
<span><span class="va">response</span></span></code></pre></div>
<p>Search based on the date created:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>filters <span class="op">=</span> <span class="st">'[{"and":[{"and":[["created_at__range",["2021-11-21","2021-12-28"]]]}]}]'</span><span class="op">)</span></span>
<span><span class="va">response</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Advanced search query</li>
</ol>
<p>The search function has embedded pagination in itself, so by setting
that attribute to true, it will fetch all results (warning: that
operation may be costly and time-consuming).</p>
<p>By performing an advanced search using query argument, only 100
objects are returned and you may see the reason for that in the
following output message:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Advanced search</span></span>
<span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of objects in the response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span></span></code></pre></div>
<p>We can perform a request function call to get the full API response
and see how many results we have in total:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.request.html">GlobalSearch.request</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span><span class="op">)</span></span>
<span><span class="va">response</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<p>There are 1407 objects in total but we have only 100 of them returned
as default. In order to get all the results you may use parameter
paginate = TRUE (please note that retrieving all objects may take a
while):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span>, paginate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, instead of using paginate parameter, you may use the
limit parameter instead. Here we’re setting a limit to 500 objects:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GlobalSearch.search.html">GlobalSearch.search</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"fuji"</span>, limit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Getting the Global Search subjects</li>
</ol>
<p>Similar to the search function to get the result objects in the
previous sections, we can use the subjects function to get a data frame
containing only subjects:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GlobalSearch.subjects.html">GlobalSearch.subjects</a></span><span class="op">(</span>entities <span class="op">=</span> <span class="st">'[["gene","BRCA2"]]'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="annotate-with-dataset-queries">Annotate with Dataset Queries<a class="anchor" aria-label="anchor" href="#annotate-with-dataset-queries"></a>
</h3>
<p>EDP makes it possible to annotate a field with data from any other
dataset. Users can run any dataset query in an expression and use it to
annotate a field.</p>
<p>In this example, we have a list of variants in the EDP variant ID
format. We will annotate them with information about dataset presence
(where has this variant been seen?), clinical significance, population
allele frequencies, and prevalence in cancer types. Users can easily add
their own annotation datasets by importing them into EDP and querying
them in an expression.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Caplan, Karl Forner, QuartzBio.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last modified: 13-May-2025 Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
